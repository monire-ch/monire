---
import "aos/dist/aos.css";
import "@/styles/globals.css";

import Header from "@/components/global/header/Header.astro";
import Footer from "@/components/global/Footer.astro";
import Head from "@/components/global/Head.astro";
import removeEmptyKeys from "@/lib/utils/removeEmptyKeys";
import type { JSONLDProps } from "@/lib/utils/JsonLdGenerator";
import BreakpointIndicator from "./components/widgets/BreakpointIndicator.astro";
import GlobalScripts from "./components/widgets/GlobalScripts.astro";
import PageLoader from "./components/utilities/PageLoader.astro";
import config from ".astro/config.generated.json" with { type: "json" };
import CookieBanner from "@/components/global/CookieBanner.astro";
import ContactModal from "@/components/widgets/ContactModal.astro";

type Props = JSONLDProps & {
  className?: string;
  fitToScreen?: boolean;
  draft?: boolean;
  metaTitle?: string;
  metaDescription?: string;
  robots?: string;
  excludeFromSitemap?: boolean;
  customSlug?: string;
  canonical?: string;
  status?: number;
  keywords?: string[]; // Array of strings
  disableTagline?: boolean;
  structuredData?: Props;
  sectionSpacing?: "md" | "lg";
};

let { sectionSpacing = "lg", structuredData } = Astro.props;

let props = removeEmptyKeys(Astro.props);

const sectionSpacingClass =
  sectionSpacing === "md" ? "has-section-spacing-md" : "has-section-spacing-lg";
---

<!doctype html>
<html lang={config.settings.multilingual.defaultLanguage || "en"}>
  <Head {...props} structuredData={structuredData} />
  <body class:list={[Astro.props.homepage && "body-homepage site-shell"]}>
    {!Astro.props.homepage && <PageLoader />}
    <Header {...props} />
    <main class:list={["site-main", sectionSpacingClass, Astro.props.class]}>
      <slot />
      <CookieBanner />
    </main>
    <Footer />
    <ContactModal />
    <GlobalScripts />
    <BreakpointIndicator />
  </body>
</html>

<style is:global>
  .site-shell {
    min-height: 100vh;
    min-height: 100dvh;
    display: flex;
    flex-direction: column;
  }

  .site-main {
    flex: 1 0 auto;
}
  body.body-homepage {
    background-color: var(--color-primary);
  }
</style>
