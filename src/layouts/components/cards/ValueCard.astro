---
import { markdownify } from "@/lib/utils/textConverter";

interface Props {
  title: string;
  description: string;
  icon?: string;
  featured?: boolean;
}

const { title, description, featured = false } = Astro.props;
const firstToken = title?.trim().split(/\s+/)[0] ?? "";
const hasMetricToken = /\d/.test(firstToken);
const displayTitle =
  hasMetricToken && featured ? title.replace(/^\S+\s*/, "") : title;
const cardStyle = featured
  ? "background-image: var(--gradient-about-card-dark); border-color: var(--color-about-card-border-dark);"
  : "background-image: var(--gradient-about-card-light); border-color: var(--color-about-card-border-soft);";
const glowStyle = featured
  ? "background: var(--color-about-card-glow-dark);"
  : "background: var(--color-about-card-glow-light);";
---

<div
  class:list={[
    "value-card relative h-full w-full max-w-[25rem] overflow-hidden rounded-[18px] border p-6 transition-all duration-300 md:p-7",
    "hover:-translate-y-0.5",
    featured ? "text-white" : "text-monire-deep-teal",
  ]}
  style={cardStyle}>
  <div
    class="pointer-events-none absolute -right-14 -bottom-14 h-44 w-44 rounded-full blur-3xl"
    style={glowStyle}
  />
  {
    hasMetricToken && featured && (
      <div class="relative mb-1 text-6xl leading-none font-semibold tracking-tight md:text-7xl">
        {firstToken}
      </div>
    )
  }
  <div class="relative mb-4">
    {
      title && (
        <h3
          class:list={[
            "leading-snug font-semibold tracking-tight",
            featured ? "text-white" : "text-monire-deep-teal",
          ]}
          style="font-size: var(--text-card-title);"
          set:html={markdownify(displayTitle)}
        />
      )
    }
  </div>
  {
    description && (
      <p
        class:list={[
          "relative text-[1rem] leading-relaxed",
          featured ? "text-white/90" : "text-monire-deep-teal/90",
        ]}
        set:html={markdownify(description)}
      />
    )
  }
</div>
