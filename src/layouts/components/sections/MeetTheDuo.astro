---
import { markdownify } from "@/lib/utils/textConverter";
import { getEntryCTM } from "@/lib/contentParser.astro";
import type { Section } from "@/types";
import overrideObjects from "@/lib/utils/overrideObjects.ts";
import SocialMediaLink from "@/layouts/components/social/SocialMediaLink.astro";
import OptimizedImage from "@/components/utilities/OptimizedImage.astro";

type meetTheDuoSectionType = Section & {
  items: {
    name: string;
    title: string;
    image: string;
    role: string;
    languages: string;
    linkedin: string;
  }[];
};

type Props = {
  content?: meetTheDuoSectionType;
};

let defaultContent = (
  await getEntryCTM("sections", "meet-the-duo", Astro.currentLocale)
)?.data as meetTheDuoSectionType;

let actualContent = overrideObjects(
  { ...defaultContent },
  Astro.props.content,
) as meetTheDuoSectionType;

let { title, items } = actualContent as meetTheDuoSectionType;
const cofounderLine = items.map((item) => item.name).join(" & ");
---

<section class="relative py-16 md:py-24">
  <div class="container mx-auto space-y-12 md:space-y-16">
    <div class="space-y-4 text-left">
      {
        title && (
          <h2 class="section-title font-semibold text-white capitalize">
            {markdownify(title)}
          </h2>
        )
      }
      {
        cofounderLine && (
          <p class="text-xs tracking-[0.16em] text-white/60 uppercase">
            {`Co-Founders: ${cofounderLine}`}
          </p>
        )
      }
      <p class="max-w-2xl text-base leading-relaxed text-white/80 md:text-lg">
        Two senior developers, two complementary perspectives, one shared
        standard for quality.
      </p>
    </div>

    <div class="space-y-8">
      {
        items.map((item, index) => (
          <article
            class="grid gap-6 border-t pt-6 text-left md:grid-cols-12 md:items-center md:gap-8"
            style="border-color: var(--color-duo-profile-divider);">
            <div
              class:list={[
                "w-full max-w-[340px] overflow-hidden rounded-3xl border md:col-span-5",
                index % 2 === 1 ? "md:order-2" : "md:order-1",
                index % 2 === 1 ? "md:justify-self-end" : "md:justify-self-start",
              ]}
              style="border-color: var(--color-duo-collage-border); background: var(--color-duo-collage-surface);">
              <OptimizedImage
                src={item.image}
                width={640}
                height={700}
                alt={item.name}
                class="aspect-[4/5] w-full object-cover object-center"
              />
            </div>

            <div
              class:list={[
                "space-y-3 md:col-span-7",
                index % 2 === 1 ? "md:order-1" : "md:order-2",
              ]}>
              <h3 class="text-3xl leading-tight font-semibold text-white">
                {item.name}
              </h3>
              <p class="text-base text-white/84">{item.role}</p>
              <p class="text-sm text-white/65">{item.languages}</p>
              <div class="pt-2">
                <SocialMediaLink
                  size="sm"
                  layout="modern"
                  label="linkedin"
                  url={item.linkedin}
                  icon="/images/icons/svg/linkedin.svg"
                />
              </div>
            </div>
          </article>
        ))
      }
    </div>
  </div>
</section>
