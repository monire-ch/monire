---
import { markdownify } from "@/lib/utils/textConverter";
import { getEntryCTM } from "@/lib/contentParser.astro";
import type { Section } from "@/types";
import overrideObjects from "@/lib/utils/overrideObjects.ts";
import SocialMediaLink from "@/layouts/components/social/SocialMediaLink.astro";
import OptimizedImage from "@/components/utilities/OptimizedImage.astro";

type meetTheDuoSectionType = Section & {
  items: {
    name: string;
    title: string;
    image: string;
    role: string;
    languages: string;
    linkedin: string;
  }[];
};

type Props = {
  content?: meetTheDuoSectionType;
};

let defaultContent = (
  await getEntryCTM("sections", "meet-the-duo", Astro.currentLocale)
)?.data as meetTheDuoSectionType;

let actualContent = overrideObjects(
  { ...defaultContent },
  Astro.props.content,
) as meetTheDuoSectionType;

let { title, items } = actualContent as meetTheDuoSectionType;
---

<section
  class="meet-duo-vibe relative overflow-hidden py-16 text-center md:py-24">
  <div class="meet-duo-orb meet-duo-orb-1" aria-hidden="true"></div>
  <div class="meet-duo-orb meet-duo-orb-2" aria-hidden="true"></div>
  <div class="container mx-auto space-y-12 md:space-y-16">
    {
      title && (
        <h2 class="section-title font-semibold text-white capitalize">
          {markdownify(title)}
        </h2>
      )
    }

    <div class="grid gap-6 md:grid-cols-2">
      {
        items.map((item, index) =>
          (() => {
            const isLight = index % 2 === 0;
            const surface = isLight
              ? "var(--gradient-about-card-light)"
              : "var(--gradient-about-card-dark)";
            const border = isLight
              ? "var(--color-about-card-border-light)"
              : "var(--color-about-card-border-dark)";
            const glow = isLight
              ? "var(--color-about-card-glow-light)"
              : "var(--color-about-card-glow-dark)";

            return (
              <div
                class="relative overflow-hidden rounded-3xl border p-6 text-left md:p-8"
                style={`background-image: ${surface}; border-color: ${border};`}>
                <div
                  class="pointer-events-none absolute -right-10 -bottom-10 h-32 w-32 rounded-full blur-2xl"
                  style={`background: ${glow};`}
                />
                <div class="relative z-10 flex h-full flex-col gap-5">
                  {item.image && (
                    <div class="h-28 w-28 overflow-hidden rounded-2xl border border-white/20">
                      <OptimizedImage
                        src={item.image}
                        width={112}
                        height={112}
                        alt={item.name}
                        class="h-full w-full object-cover"
                      />
                    </div>
                  )}
                  <div class="space-y-1">
                    <h3 class="text-2xl leading-tight font-semibold text-white">
                      {item.name}
                    </h3>
                    <p class="text-base text-white/82">{item.role}</p>
                  </div>
                  <p class="text-sm text-white/70">{item.languages}</p>
                  <SocialMediaLink
                    size="sm"
                    layout="modern"
                    label="linkedin"
                    url={item.linkedin}
                    icon="/images/icons/svg/linkedin.svg"
                  />
                </div>
              </div>
            );
          })(),
        )
      }
    </div>
  </div>
</section>

<style>
  .meet-duo-vibe {
    background: var(--gradient-vibe-dark);
  }

  .meet-duo-orb {
    position: absolute;
    border-radius: 9999px;
    filter: blur(64px);
    pointer-events: none;
  }

  .meet-duo-orb-1 {
    top: -3rem;
    left: -4rem;
    width: 18rem;
    height: 18rem;
    background: var(--color-vibe-orb-strong-soft);
  }

  .meet-duo-orb-2 {
    right: -5rem;
    bottom: -3rem;
    width: 16rem;
    height: 16rem;
    background: var(--color-vibe-orb-soft-soft);
  }
</style>
